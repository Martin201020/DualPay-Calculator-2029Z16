<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#4c1d95"> <title>DualPay Colorful</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png"> <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Outfit', sans-serif; background: #0f172a; overflow-x: hidden; }
        h1 { font-family: 'Comfortaa', cursive; }
        
        /* –ê–Ω–∏–º–∏—Ä–∞–Ω –ì—Ä–∞–¥–∏–µ–Ω—Ç –§–æ–Ω */
        .gradient-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* –°—Ç—ä–∫–ª–µ–Ω –µ—Ñ–µ–∫—Ç */
        .glass-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        input { font-weight: 800 !important; font-size: 1.2rem !important; color: white !important; }
        input::placeholder { color: rgba(255, 255, 255, 0.5); font-weight: 400; }
        
        /* –°–∫—Ä–∏–≤–∞–Ω–µ –Ω–∞ —Å—Ç—Ä–µ–ª–∫–∏—Ç–µ –Ω–∞ input type number */
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        
        #installBtn { display: none; } /* –°–∫—Ä–∏—Ç–æ –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ */
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="gradient-bg"></div>

    <div class="glass-panel w-full max-w-md rounded-[2rem] p-6 relative">
        
        <header class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-black text-white drop-shadow-md">DualPay</h1>
                <p class="text-xs text-white/80 font-bold uppercase tracking-widest">Euro Tool üáßüá¨üá™üá∫</p>
            </div>
            <button id="installBtn" class="bg-white/20 hover:bg-white/30 text-white p-2 rounded-xl transition backdrop-blur-md border border-white/20">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
            </button>
        </header>

        <div class="space-y-6">
            <div class="bg-black/20 p-4 rounded-2xl border border-white/10">
                <label class="block text-xs font-bold text-pink-300 uppercase mb-1 ml-1">–î—ä–ª–∂–∏–º–∞ –°—É–º–∞</label>
                <div class="flex items-center">
                    <input type="number" id="totalAmount" class="w-full bg-transparent outline-none" placeholder="0.00">
                    <select id="totalCurrency" class="bg-pink-500 text-white font-bold rounded-lg px-2 py-1 border-none outline-none cursor-pointer">
                        <option value="BGN">–õ–í</option>
                        <option value="EUR">‚Ç¨</option>
                    </select>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <div class="bg-black/20 p-4 rounded-2xl border border-white/10 focus-within:ring-2 ring-cyan-400 transition">
                    <label class="block text-xs font-bold text-cyan-300 uppercase mb-1">–î–∞–¥–µ–Ω–æ –õ–í.</label>
                    <input type="number" id="paidBGN" class="w-full bg-transparent outline-none" placeholder="0.00">
                </div>
                <div class="bg-black/20 p-4 rounded-2xl border border-white/10 focus-within:ring-2 ring-yellow-400 transition">
                    <label class="block text-xs font-bold text-yellow-300 uppercase mb-1">–î–∞–¥–µ–Ω–æ ‚Ç¨</label>
                    <input type="number" id="paidEUR" class="w-full bg-transparent outline-none" placeholder="0.00">
                </div>
            </div>
        </div>

        <div class="mt-8 min-h-[140px]">
            <div id="errorBox" class="hidden bg-red-500 text-white p-4 rounded-2xl text-center font-bold shadow-lg animate-bounce">
                ‚ö†Ô∏è –ù–ï–î–û–°–¢–ê–¢–™–ß–ù–ê –°–£–ú–ê!
            </div>

            <div id="resultArea" class="hidden transform transition-all duration-500 scale-100">
                <div class="relative overflow-hidden rounded-[2rem] bg-gradient-to-r from-violet-600 to-indigo-600 p-6 text-center shadow-xl border border-white/20">
                    <div class="absolute top-0 right-0 -mr-8 -mt-8 w-24 h-24 rounded-full bg-white/20 blur-xl"></div>
                    
                    <p class="text-xs font-bold text-indigo-200 uppercase tracking-widest mb-2">–†–µ—Å—Ç–æ –∑–∞ –≤—Ä—ä—â–∞–Ω–µ</p>
                    <div class="text-5xl font-black text-white drop-shadow-lg" id="mainChangeText">0.00 ‚Ç¨</div>
                    <div class="mt-3 inline-block px-4 py-1 bg-black/30 rounded-full border border-white/10 text-sm font-semibold text-indigo-100" id="subChangeText">
                        = 0.00 –ª–≤.
                    </div>
                </div>
            </div>
            
            <div id="placeholderText" class="text-center text-white/50 text-sm mt-8">
                –í—ä–≤–µ–¥–µ—Ç–µ —Å—É–º–∏ –∑–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ
            </div>
        </div>

        <footer class="mt-8 text-center border-t border-white/10 pt-4">
            <p class="text-[10px] font-bold text-white/60">–§–ò–ö–°–ò–†–ê–ù –ö–£–†–°: 1.95583</p>
        </footer>
    </div>

    <script>
        const RATE = 1.95583;

        // PWA Installation Logic
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'block';
        });

        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                installBtn.style.display = 'none';
            }
        });

        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW fail', err));
            });
        }

        // Calculator Logic
        const inputs = ['totalAmount', 'paidBGN', 'paidEUR', 'totalCurrency'];
        inputs.forEach(id => document.getElementById(id).addEventListener('input', calculate));

        function calculate() {
            const total = parseFloat(document.getElementById('totalAmount').value) || 0;
            const currency = document.getElementById('totalCurrency').value;
            const bgn = parseFloat(document.getElementById('paidBGN').value) || 0;
            const eur = parseFloat(document.getElementById('paidEUR').value) || 0;

            const totalInBgn = (currency === 'EUR') ? total * RATE : total;
            const paidInBgn = bgn + (eur * RATE);
            const changeInBgn = paidInBgn - totalInBgn;

            const resArea = document.getElementById('resultArea');
            const errBox = document.getElementById('errorBox');
            const placeholder = document.getElementById('placeholderText');

            // Reset UI
            errBox.classList.add('hidden');
            resArea.classList.add('hidden');
            placeholder.classList.remove('hidden');

            if (total > 0) {
                placeholder.classList.add('hidden');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å —Ç–æ–ª–µ—Ä–∞–Ω—Å –∑–∞ –ø–ª–∞–≤–∞—â–∞ –∑–∞–ø–µ—Ç–∞—è
                if (paidInBgn < (totalInBgn - 0.009)) {
                    errBox.classList.remove('hidden');
                } else {
                    resArea.classList.remove('hidden');
                    const changeInEur = changeInBgn / RATE;
                    
                    document.getElementById('mainChangeText').innerText = changeInEur.toFixed(2) + ' ‚Ç¨';
                    document.getElementById('subChangeText').innerText = '= ' + changeInBgn.toFixed(2) + ' –ª–≤.';
                }
            }
        }
    </script>
</body>
</html>


